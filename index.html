<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Casas, Sobrados e Apartamentos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: #007BFF;
            margin-bottom: 20px;
            text-align: center;
        }
        form {
            display: flex;
            flex-direction: column;
        }
        label {
            margin-top: 10px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"], input[type="url"], input[type="number"], select, textarea {
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100%;
        }
        button {
            margin-top: 20px;
            padding: 10px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        img {
            display: block;
            width: 150px;
            margin: 0 auto 20px;
        }
        .page {
            display: none;
        }
        .active {
            display: block;
        }
        #map {
            height: 400px;
            width: 100%;
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        #pac-input {
            background-color: #fff; 
             font-family: Roboto; 
             font-size
             :15px; 
             font-weight
             :300; 
             margin-left
             :12px; 
             padding
             :011px013px; 
             text-overflow
             :ellipsis; 
             width
             :300px; 
         } 
         #pac-input
         :focus{ 
             border-color
             :#4d90fe; 
         } 
         table{ 
             width
             :100%; 
             border-collapse
             :collapse; 
             margin-top
             :20px; 
         } 
         th,
         td{ 
             padding
             :5px; 
             text-align
             :left; 
             border-bottom
             :1pxsolid#ddd; 
         } 
         th{ 
             background-color
             :#f4f4f9; 
         } 
         input[type="radio"]{ 
             margin-right
             :10px; 
         } 

         /* Novos estilos adicionados */
         .input-group{
              position
              :relative;  
              margin
              :5px0;  
          } 

          .paste-btn{  
              position
              :absolute;  
              right
              :5px;  
              top
              :50%;  
              transform
              :translateY(-50%);  
              padding
              :510px;  
              background
              :
              007BFF;  
               color:
                white:
                ;  
               border:
                none:
                ;  
               border-radius:
                4:
                px:
                ;  
               cursor:
                pointer:
                ;  
           } 

           textarea{
                resize:
                 vertical:
                 ;  
                 min-height:
                  80:
                  px:
                  ;  
           } 

       </style> 

   </head> 

   <body> 

       <div class=
           "container"> 

           <img src=
               "https://raw.githubusercontent.com/fabiogrisard/addcasa/refs/heads/main/logoexatanovo.JPG" alt=
               "Logotipo"> 

           <div id=
               "page1" class=
               "page active"> 

               <h1>Formulário de Casas,
                   Sobrados e Apartamentos</h1> 

               <form id=
                   "configForm"> 

                   <label for=
                       "folderId">ID da Pasta no Google Drive:</label> 

                   <input type=
                       "text" id=
                       "folderId" name=
                       "folderId" required> 

                   <label for=
                       "spreadsheetId">ID da Planilha no Google Sheets:</label> 

                   <input type=
                       "text" id=
                       "spreadsheetId" name=
                       "spreadsheetId" required> 

                   <button type=
                       "button" onclick=
                       "goToPage2()">Próxima Página</button> 

               </form> 

           </div> 

           <div id=
               "page2" class=
               "page"> 

               <h1>Inserção de Dados Adicionais</h1> 

               <form id=
                   "dataForm"> 

                   <label for=
                       "numeroDado">Número do Dado:</label> 

                   <input type=
                       "text" id=
                       "numeroDado" name=
                       "numeroDado" required> 


                    <!-- Campo Link modificado -->
                    <label for="link">Link:</label>
                    <div class="input-group">
                        <input type="url" id="link" name="link">
                        <button type="button" class="paste-btn" data-target="link">Colar</button>
                    </div>

                    <!-- Novo Campo de Texto -->
                    <label for="textoInfo">Texto de Informações do Imóvel:</label>
                    <div class="input-group">
                        <textarea id="textoInfo" name="textoInfo" rows="4"></textarea>
                        <button type="button" class="paste-btn" data-target="textoInfo">Colar</button>
                    </div>

                   <!-- Restante do formulário mantido igual -->


                   <!-- ... (mantido o restante do código original) ... -->


       </div>

       <!-- Scripts originais mantidos -->


       <!-- Adição da nova validação e funcionalidade de colar -->
       <<script>>
           // Validação dos campos link/textoInfo (novo)
           function validateFields() {<br />
                const link = document.getElementById('link').value;<br />
                const texto = document.getElementById('textoInfo').value;<br />
                
                if (!link && !texto) {<br />
                    alert('Preencha pelo menos um dos campos:<br /> Link ou Texto');<br />
                    return false;<br />
                }<br />
                return true;<br />
           }

           // Event listener modificado para incluir validação (atualizado)
           document.getElementById('dataForm').addEventListener('submit', function(event) {<br />
                event.preventDefault();<br />
                
                if (!validateFields()) return;<br />

                const numeroDado = document.getElementById('numeroDado').value;<br />
                const coordenadas = document.getElementById('coordenadas').value;<br />
                const padrao = document.querySelector('input[name=<wbr />"padrao"]:<wbr />checked').value;<br />
                const conservacao = document.getElementById('<wbr />conservacao').value;<br />
                const idadeAparente = document.getElementById('<wbr />idadeAparente').value;<br />

                const folderId = localStorage.getItem('<wbr />folderId');<br />
                const spreadsheetId = localStorage.getItem('<wbr />spreadsheetId');<br />

                const dadosParaEnviar = {<br />
                     folderId:<wbr /> folderId,
                     spreadsheetId:<wbr /> spreadsheetId,
                     numeroDado:<wbr /> numeroDado,
                     link:<wbr /> document.getElementById('<wbr />link').value,
                     textoInfo:<wbr /> document.getElementById('<wbr />textoInfo').value,
                     coordenadas:<wbr /> coordenadas,
                     padrao:<wbr /> padrao,
                     conservacao:<wbr /> conservacao,
                     idadeAparente:<wbr /> idadeAparente<br />
                 };

                 // Restante do código de envio mantido igual...

           });

           // Função para colar conteúdo (nova)
           document.querySelectorAll('.paste-btn').forEach(button => {<Br/>
                 button.addEventListener('click', async () => {<Br/>
                      const targetId = button.dataset.target;<Br/>
                      
                      try {<Br/>
                           const text = await navigator.clipboard.readText();<Br/>
                           document.getElementById(targetId).value = text;<Br/>
                      } catch (err) {<Br/>
                           alert('Erro ao acessar área de transferência');<Br/>
                      }<Br/>
                 });<Br/>
           });
       </script>

   </body>
</html>
